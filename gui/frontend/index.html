<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automated wetland classification using Google Earth Engine satellite embeddings and machine learning">
    <title>Wetland Mapping | ELEC 498 Capstone</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üåø</div>
                    <div class="logo-text">
                        <h1>Wetland Mapping</h1>
                        <p>ELEC 498 Capstone - Group 46</p>
                    </div>
                </div>
                <div class="team-info">
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">
                        Jacob Badali ‚Ä¢ Connor Rewa ‚Ä¢ Max Marsland ‚Ä¢ Gavin Nyhof
                    </p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <div class="grid">
                <!-- Left Sidebar: Controls -->
                <aside class="sidebar">
                    <!-- Upload Section -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">üìÅ</div>
                            <h3 class="card-title">Data Upload</h3>
                        </div>
                        
                        <div class="upload-zone" id="uploadZone">
                            <div class="upload-icon">‚òÅÔ∏è</div>
                            <p><strong>Drop your data file here</strong></p>
                            <p>or click to browse</p>
                            <small>Supported: .npz files with 64-dimensional embeddings</small>
                            <input type="file" id="fileInput" accept=".npz" style="display: none;">
                        </div>
                        
                        <div id="fileInfo" class="hidden" style="margin-top: var(--space-md);">
                            <div style="background: var(--bg-glass); padding: var(--space-sm); border-radius: var(--radius-sm); border: var(--border-glass);">
                                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: var(--space-xs);">Selected File:</p>
                                <p id="fileName" style="font-weight: 600; word-break: break-all;"></p>
                                <p id="fileSize" style="font-size: 0.875rem; color: var(--text-muted); margin-top: var(--space-xs);"></p>
                            </div>
                        </div>
                        
                        <button id="classifyBtn" class="btn btn-primary mt-lg" style="width: 100%;" disabled>
                            <span>üîç</span>
                            <span>Classify Wetlands</span>
                        </button>
                    </div>

                    <!-- Legend -->
                    <div class="card mt-lg">
                        <div class="card-header">
                            <div class="card-icon">üó∫Ô∏è</div>
                            <h3 class="card-title">Wetland Classes</h3>
                        </div>
                        
                        <div class="legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-0);"></div>
                                <span class="legend-label">Background</span>
                                <span class="legend-value" data-class="0">-</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-1);"></div>
                                <span class="legend-label">Marsh</span>
                                <span class="legend-value" data-class="1">-</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-2);"></div>
                                <span class="legend-label">Swamp</span>
                                <span class="legend-value" data-class="2">-</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-3);"></div>
                                <span class="legend-label">Fen</span>
                                <span class="legend-value" data-class="3">-</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-4);"></div>
                                <span class="legend-label">Bog</span>
                                <span class="legend-value" data-class="4">-</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background: var(--wetland-5);"></div>
                                <span class="legend-label">Open Water</span>
                                <span class="legend-value" data-class="5">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Model Info -->
                    <div class="card mt-lg">
                        <div class="card-header">
                            <div class="card-icon">ü§ñ</div>
                            <h3 class="card-title">Model Information</h3>
                        </div>
                        
                        <div style="display: grid; gap: var(--space-sm);">
                            <div>
                                <p style="font-size: 0.875rem; color: var(--text-muted);">Algorithm</p>
                                <p style="font-weight: 600;">Random Forest Classifier</p>
                            </div>
                            <div>
                                <p style="font-size: 0.875rem; color: var(--text-muted);">Features</p>
                                <p style="font-weight: 600;">64-dimensional GEE Embeddings</p>
                            </div>
                            <div>
                                <p style="font-size: 0.875rem; color: var(--text-muted);">Region</p>
                                <p style="font-weight: 600;">Bow River Basin, AB</p>
                            </div>
                            <div>
                                <p style="font-size: 0.875rem; color: var(--text-muted);">Resolution</p>
                                <p style="font-weight: 600;">10m Spatial Resolution</p>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Right Content: Map & Results -->
                <div class="main-content">
                    <!-- Map Visualization -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-icon">üó∫Ô∏è</div>
                            <h3 class="card-title">Classification Map</h3>
                        </div>
                        
                        <div class="map-container">
                            <div id="mapPlaceholder" class="map-placeholder">
                                <div class="map-placeholder-icon">üåç</div>
                                <p style="color: var(--text-secondary);">Upload data to view classification results</p>
                            </div>
                            <div id="map" class="hidden"></div>
                        </div>
                    </div>

                    <!-- Results Section -->
                    <div id="resultsSection" class="results-section">
                        <!-- Statistics -->
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">üìä</div>
                                <h3 class="card-title">Classification Statistics</h3>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="statTotal">-</div>
                                    <div class="stat-label">Total Samples</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="statClasses">6</div>
                                    <div class="stat-label">Classes</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="statAccuracy">-</div>
                                    <div class="stat-label">Confidence</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="statTime">-</div>
                                    <div class="stat-label">Processing Time</div>
                                </div>
                            </div>
                            
                            <!-- Chart Container -->
                            <div style="margin-top: var(--space-lg);">
                                <canvas id="distributionChart"></canvas>
                            </div>
                        </div>

                        <!-- Export Options -->
                        <div class="card mt-lg">
                            <div class="card-header">
                                <div class="card-icon">üíæ</div>
                                <h3 class="card-title">Export Results</h3>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--space-sm);">
                                <button class="btn btn-secondary" id="exportCSV">
                                    <span>üìÑ</span>
                                    <span>Export CSV</span>
                                </button>
                                <button class="btn btn-secondary" id="exportJSON">
                                    <span>üìã</span>
                                    <span>Export JSON</span>
                                </button>
                                <button class="btn btn-secondary" id="exportPNG">
                                    <span>üñºÔ∏è</span>
                                    <span>Save Map PNG</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading"></div>
        <p style="font-size: 1.125rem; font-weight: 600;">Classifying wetlands...</p>
        <p style="color: var(--text-secondary);">This may take a moment</p>
        <div style="width: 300px; margin-top: var(--space-md);">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    
    <!-- Application JavaScript -->
    <script src="app.js"></script>
</body>
</html>
